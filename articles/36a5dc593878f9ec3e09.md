---
title: "(ï¾ƒï½¯ï¾ƒï½¹ï¾ƒï½¯ï¾ƒï½°ï¾ƒï½°ï¾ƒï¾ƒï½°)ãƒŸãƒ‹ãƒ‰ãƒ©èªç¿»è¨³æ©Ÿï½"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["è‡ªç„¶è¨€èªå‡¦ç†","Python3","COTOHA"]
published: true
---
æ—¥æœ¬èªã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€ãƒŸãƒ‹ãƒ‰ãƒ©èªã«ç¿»è¨³ã—ã¦ãã‚Œã‚‹ã²ã¿ã¤é“å…·ã‚’é–‹ç™ºã—ã¾ã—ãŸ!

# ã¯ã˜ã‚ã«

ãƒŸãƒ‹ãƒ‰ãƒ©ãŒè©±ã™ãƒŸãƒ‹ãƒ‰ãƒ©èªã€ã¨ã„ã†è¨€è‘‰ã‚’ã”å­˜çŸ¥ã§ã™ã‹?
ã‚¢ãƒ‹ãƒ¡ã§ã¯ã€Œãƒ‰ãƒ©ãƒ‰ãƒ©ã€ã¨ã‹ã€Œãƒ‰ãƒ©ãƒ©ï½ã€ãªã©ã€æ­£è¦è¡¨ç¾ã§è¡¨ã™ã¨`^(ãƒ‰ãƒ¼*ãƒ©+ãƒ¼*)+$`ãã‚‰ã„ã®ãƒ¬ãƒ‘ãƒ¼ãƒˆãƒªãƒ¼ã§ã™
ã—ã‹ã—ã€æ¼«ç”»ã®ã»ã†ã§ã¯
![10644063_761250850582759_516278085_n.jpg](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/56006/49a357b7-9fba-9c7d-d66d-ba60cf082131.jpeg)
ã¨ã€`^(ãƒ‰ãƒ¼*ãƒ©+ãƒ¼*)+$`ã«å½“ã¦ã¯ã¾ã‚‰ãªã„ã€Œã‚¹ãƒ¼ã‚¹ãƒ¼ã‚·ãƒ¼ã‚·ãƒ¼ãƒ¯ãƒ¼ãƒ¯ãƒ¼ãƒŠãƒ¼ãƒŠãƒ¼ã€ã¨å–‹ã£ã¦ã„ã‚‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã‹!
ãƒ‰ãƒ©ãƒŸã¡ã‚ƒã‚“ã®ã‚»ãƒªãƒ•ã‹ã‚‰æ—¥æœ¬èªã«è¨³ã™ã‚‹ã¨ã€Œã™ã£ã‹ã‚Šèª¿ã¹ã¦ã€æ‚ªã„ã¨ã“ã‚ã‚’ç›´ã—ã¾ã—ãŸã€ã‚’è¨€ã£ã¦ãã†ã§ã™

ã“ã®ã€Œã™ã£ã‹ã‚Šèª¿ã¹ã¦ã€æ‚ªã„ã¨ã“ã‚ã‚’ç›´ã—ãŸã‚ˆã€ã‹ã‚‰ã€Œã‚¹ãƒ¼ã‚¹ãƒ¼ã‚·ãƒ¼ã‚·ãƒ¼ãƒ¯ãƒ¼ãƒ¯ãƒ¼ãƒŠãƒ¼ãƒŠãƒ¼ã€ã‚’é–‹ç™ºã—ã¾ã—ãŸ

# ä½¿ç”¨æŠ€è¡“åŠã³ç’°å¢ƒ

* Python 3.7.0
* [COTOHA API](https://api.ce-cotoha.com/)

# ç¿»è¨³æ©Ÿã®ä»•æ§˜

ãƒ‰ãƒ©ãˆã‚‚ã‚“å…¬å¼ã«ãƒŸãƒ‹ãƒ‰ãƒ©èªã®ãƒ«ãƒ¼ãƒ«çš„ãªã‚‚ã®ã¯è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã€ã•ã£ãã®1ã‚³ãƒã‹ã‚‰ã²ã­ã‚Šå‡ºã—ã¾ã™
ã‚‚ã—ã€ãƒŸãƒ‹ãƒ‰ãƒ©èªã®ãƒ«ãƒ¼ãƒ«ãŒã‚ã£ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„

## 1ã‚³ãƒã‹ã‚‰ã‚ã‹ã‚‹ã“ã¨

ã€Œã‚¹ãƒ¼ã‚¹ãƒ¼ã‚·ãƒ¼ã‚·ãƒ¼ãƒ¯ãƒ¼ãƒ¯ãƒ¼ãƒŠãƒ¼ãƒŠãƒ¼ã€ = ã€Œã™ã£ã‹ã‚Šèª¿ã¹ã¦ã€æ‚ªã„ã¨ã“ã‚ã‚’ç›´ã—ãŸã‚ˆã€
ã§ã‚ã‚‹ã®ã¯ã»ã¼ç¢ºå®šã£ã½ãã†ã§ã™(ã€Œç›´ã—ãŸã‚ˆã€ã¯ã€Œç›´ã—ã¾ã—ãŸã€ã‚„ã€Œç›´ã—ãŸã€ãªã©ã€è¡¨è¨˜ã‚†ã‚Œã®å¯èƒ½æ€§ã¯ã‚ã‚Šã¾ã™)

å¦å®šã‚‚ä¼šè©±ã®æµã‚Œã‹ã‚‰ã—ã¦ã€è€ƒãˆã«ãã„ã§ã™
ã€Œç›´ã—ã¾ã›ã‚“ã§ã—ãŸ(ç›´ã›ã¾ã›ã‚“ã§ã—ãŸ)ã€ã¨è¨€ã£ã¦ã„ã‚‹äººã«ã€Œç›´ã—ã¦ãã‚ŒãŸã®?ã€ã¨èãè¿”ã™ã®ã¯ä¸è‡ªç„¶ã‹ãªã¨

## ãƒŸãƒ‹ãƒ‰ãƒ©èªã¨æ—¥æœ¬èªã‚’ç´ä»˜ã‘

æ¬¡ã«ã€ãƒŸãƒ‹ãƒ‰ãƒ©èªã¨æ—¥æœ¬èªãŒç´ä»˜ã‘ã¦ã¿ã¾ã—ãŸ
æ³•å‰‡æ€§ã¨ã—ã¦ã€å˜ä½“ã§æ„å‘³ã®ã‚ã‚‹å˜èª(è‡ªç«‹èª)ã®é ­æ–‡å­—ã‚’ç¹°ã‚Šè¿”ã™ãƒ«ãƒ¼ãƒ«ãŒã‚ã‚Šãã†ã§ã™
è¡¨ã«ã¾ã¨ã‚ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™

|ãƒŸãƒ‹ãƒ‰ãƒ©èª|æ—¥æœ¬èª|ç™ºå£°ã™ã‚‹éŸ³ã®é ­æ–‡å­—
|---|---|---|
|ã‚¹ãƒ¼ã‚¹ãƒ¼|ã™ã£ã‹ã‚Š|ã‚¹|
|ã‚·ãƒ¼ã‚·ãƒ¼|èª¿ã¹ã¦|ã‚·|
|ãƒ¯ãƒ¼ãƒ¯ãƒ¼|æ‚ªã„ã¨ã“ã‚ã‚’|ãƒ¯|
|ãƒŠãƒ¼ãƒŠãƒ¼|ç›´ã—ãŸã‚ˆ|ãƒŠ|

## æ—¥æœ¬èªã‚’è§£æ

è‡ªç«‹èªã®é ­æ–‡å­—ã‚’ç¹°ã‚Šè¿”ã™ãƒ«ãƒ¼ãƒ«ãŒåˆ†ã‹ã£ãŸã¨ãªã‚Œã°ã€ã‚ã¨ã¯ã©ã‚ŒãŒè‡ªç«‹èªãªã®ã‹ãŒã‚ã‹ã‚Œã°ç¿»è¨³æ©Ÿã®å®Œæˆã§ã™
ã“ã“ã§ã€ã€Œã™ã£ã‹ã‚Šèª¿ã¹ã¦ã€æ‚ªã„ã¨ã“ã‚ã‚’ç›´ã—ãŸã‚ˆã€ã‚’COTOHA APIã‚’ä½¿ã£ã¦è§£æã—ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸ
COTOHA APIãŒæä¾›ã™ã‚‹APIä¸€è¦§ã¯[ã“ã¡ã‚‰](https://api.ce-cotoha.com/contents/api-all.html)ã«ãªã‚Šã¾ã™ãŒã€ä»Šå›ã¯æ§‹æ–‡è§£æã‚’ä½¿ã„ã¾ã—ãŸ
è§£æã—ãŸçµæœã‚’ã™ã¹ã¦è¼‰ã›ãŸã„ã¨ã“ã‚ã§ã™ãŒã€å†—é•·ãªã®ã§é‡è¦ãªéƒ¨åˆ†ã ã‘ã‚’ã¾ã¨ã‚ã¾ã—ãŸ

|è¡¨è¨˜|å“è©|
|---|---|
|ã™ã£ã‹ã‚Š|é€£ç”¨è©|
|èª¿ã¹|å‹•è©èªå¹¹|
|æ‚ª|å½¢å®¹è©èªå¹¹|
|ç›´|å‹•è©èªå¹¹|

ã©ã†ã‚„ã‚‰ã€ä¸Šã®3å“è©ã¯ãƒŸãƒ‹ãƒ‰ãƒ©èªã®å¯¾è±¡ã«ãªã‚Šãã†ã§ã™
æœ€åˆã«è¨€ã£ã¦ãŸè‡ªç«‹èªã«ã‚‚å«ã¾ã‚Œã¦ãã†ã§ã™(é«˜æ ¡æ™‚ä»£ã§å‹‰å¼·ã—ãŸå†…å®¹ã®è¦šãˆã¦ã„ã‚‹ç¯„å›²ã§)
ä»–ã«ã‚‚è‡ªç«‹å¾Œã«ãªã‚Šãã†ãªå“è©ã¯ä»¥ä¸‹ãã‚‰ã„ãªã®ã§ã€ãã‚Œã‚‚å¯¾è±¡ã«ã—ã¦ã„ã¾ã™

* åè©
* é€£ä½“è©
* ç‹¬ç«‹è©

## åè©ã®ç²¾åº¦ã‚’ä¸Šã’ã‚‹

ã“ã‚Œã§å®Œæˆãƒ»ãƒ»ãƒ»ã‹ã¨æ€ã„ãã‚„ã€ä»Šå›ãŸã¾ãŸã¾ã€Œã™ã£ã‹ã‚Šèª¿ã¹ã¦ã€æ‚ªã„ã¨ã“ã‚ã‚’ç›´ã—ãŸã‚ˆã€ã®è§£æã§è¦‹ã¤ã‘ãŸã®ã§ã€å¯¾å‡¦ã§ããŸã®ã§ã™ãŒã€ã€Œã¨ã“ã‚ã€ãŒåè©ã¨ã—ã¦åˆ¤å®šã•ã‚Œã¾ã—ãŸ
ã¤ã¾ã‚Šã€ã“ã®ã¾ã¾å®Ÿè£…ã™ã‚‹ã¨ã€Œã‚¹ãƒ¼ã‚¹ãƒ¼ã‚·ãƒ¼ã‚·ãƒ¼ãƒ¯ãƒ¼ãƒ¯ãƒ¼ãƒˆãƒ¼ãƒˆãƒ¼ãƒŠãƒ¼ãƒŠãƒ¼ã€ã¨ã€ä½™è¨ˆãªã‚‚ã®ãŒå‡ºã¦ãã¦ã—ã¾ã„ã¾ã™
ãªã®ã§ã€ã“ã®ã€Œãƒˆãƒ¼ãƒˆãƒ¼ã€ã‚’é™¤å¤–ã—ã¾ã™
ã€Œã¨ã“ã‚ã€ã®è§£æçµæœã‚’è¦‹ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™

```json
{
    "id": 6,
    "form": "ã¨ã“ã‚",
    "kana": "ãƒˆã‚³ãƒ­",
    "lemma": "æ‰€",
    "pos": "åè©",
    "features": [],
    "dependency_labels": [
        {
            "token_id": 4,
            "label": "amod"
        },
        {
            "token_id": 7,
            "label": "case"
        }
    ],
    "attributes": {}
}
```

é™¤å¤–ã®åˆ¤å®šã«ä½¿ãˆãã†ãªéƒ¨åˆ†ãŒ`dependency_labels`ã€ä¾å­˜é–¢ä¿‚ãƒ©ãƒ™ãƒ«ã®ã¿ãªã®ã§ã€ã“ã¡ã‚‰ã‚’åˆ©ç”¨ã—ã¾ã™
[ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://api.ce-cotoha.com/contents/reference/apireference.html#parsing_io_dependency)ã‚’è¦‹ã‚‹ã¨ã€ã€Œã¨ã“ã‚ã€ã¯`token_id`ãŒ4ã®å½¢æ…‹ç´ ã«ä¿®é£¾ã•ã‚Œã¦ã„ã‚‹ã¨ã®ã“ã¨
`token_id`ãŒ4ã€ã¤ã¾ã‚Š`id`ãŒ4ã¨ãªã£ã¦ã„ã‚‹ã®ã¯ã“ã“ã«ã¯è¼‰ã›ã¦ã„ã¾ã›ã‚“ãŒã€Œæ‚ªã€ã§ã™
ã©ã†ã‚„ã‚‰ã€ä¿®é£¾å¯¾è±¡ã«ãªã‚‹ã‚‚ã®ã¯ãƒŸãƒ‹ãƒ‰ãƒ©èªã‹ã‚‰ã¯ç™ºéŸ³ã•ã‚Œãªã„ãƒ«ãƒ¼ãƒ«ã«ãªã£ã¦ã„ãã†ãªã®ã§ã€`amod`ã¯é™¤å¤–ã—ã¾ã™

# æœ€çµ‚çš„ãªã‚³ãƒ¼ãƒ‰

ä»¥ä¸Šã‚’è¸ã¾ãˆã¦å®Ÿè£…ã—ãŸã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™

```py:minidorago.py
import requests
import json
import sys
import configparser

config_ini = configparser.ConfigParser()
config_ini.read('config.ini', encoding = 'utf-8')
BASE_URL = "https://api.ce-cotoha.com/api/dev/nlp/"
# æ‰•ã„å‡ºã•ã‚ŒãŸCLIENT_IDã¨CLIENT_SECRETã‚’ç›´æ›¸ãã—ã¦ã‚‚OKã§ã™(ã‚³ãƒ”ãƒšã§èª¤ã£ã¦æ™’ã™ã®ã‚’é˜²ããŸã‚ã«configparserä½¿ã„ã¾ã—ãŸ)
CLIENT_ID = config_ini['CONOHA_CLIENT']['ID']
CLIENT_SECRET = config_ini['CONOHA_CLIENT']['SECRET']

def auth(client_id, client_secret):
    token_url = "https://api.ce-cotoha.com/v1/oauth/accesstokens"
    headers = {
        "Content-Type": "application/json",
        "charset": "UTF-8"
    }

    data = {
        "grantType": "client_credentials",
        "clientId": client_id,
        "clientSecret": client_secret
    }
    r = requests.post(token_url,
                      headers=headers,
                      data=json.dumps(data))
    return r.json()["access_token"]

def parse(sentence, access_token):
    base_url = BASE_URL
    headers = {
        "Content-Type": "application/json",
        "charset": "UTF-8",
        "Authorization": "Bearer {}".format(access_token)
    }
    data = {
        "sentence": sentence,
        "type": "default"
    }
    r = requests.post(base_url + "v1/parse",
                      headers=headers,
                      data=json.dumps(data))
    return r.json()

def exist_dependency_labels(labels, tag):
    for label in labels:
        if label["label"] == tag:
            return True
    return False

if __name__ == "__main__":
    # ãƒŸãƒ‹ãƒ‰ãƒ©èªã«ç¿»è¨³ã™ã‚‹æ–‡ç« 
    sentence = "ã™ã£ã‹ã‚Šèª¿ã¹ã¦ã€æ‚ªã„ã¨ã“ã‚ã‚’ç›´ã—ãŸã‚ˆ"
    # å®Ÿè¡Œæ™‚ã«å¼•æ•°ã§ç¿»è¨³ã™ã‚‹æ–‡ç« ãŒä¸ãˆã‚‰ã‚Œã¦ã„ãŸã‚‰ã€ãã£ã¡ã‚’ç¿»è¨³ã—ã¾ã™
    args = sys.argv
    if len(args) >= 2:
        sentence = str(args[1])

    access_token = auth(CLIENT_ID, CLIENT_SECRET)
    parse_sentence = parse(sentence, access_token)
    result_list = list()
    # ç¿»è¨³å¯¾è±¡ã®å“è©ã‚’è¨­å®š
    targets_pos = list()
    targets_pos.append("åè©")
    targets_pos.append("å‹•è©èªå¹¹")
    targets_pos.append("å½¢å®¹è©èªå¹¹")
    targets_pos.append("é€£ä½“è©")
    targets_pos.append("é€£ç”¨è©")
    targets_pos.append("ç‹¬ç«‹è©")
    for chunks in parse_sentence['result']:
        for token in chunks["tokens"]:
            if token["pos"] in targets_pos:
                if not exist_dependency_labels(token["dependency_labels"], "amod"):
                    result_list.append(token["kana"][0] + 'ãƒ¼')
                    result_list.append(token["kana"][0] + 'ãƒ¼')

    # ç¿»è¨³çµæœã‚’å‡ºåŠ›
    print(sentence)
    print('â†“')
    print(''.join(result_list))
```

[ã‚ªãƒ¬ ãƒ—ãƒ­ã‚°ãƒ©ãƒ  ã‚¦ã‚´ã‚«ã‚¹ ã‚ªãƒã‚¨ ã‚²ãƒ³ã‚·ã‚¸ãƒ³ ãƒŠãƒ«](https://qiita.com/Harusugi/items/f499e8707b36d0f570c4#%E3%82%B3%E3%83%BC%E3%83%89)ã«ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ™ãƒ¼ã‚¹ã«ä½œæˆã—ã¦ã„ã¾ã™

# å®Ÿæ¼”

ã„ã‚ã‚“ãªæ–‡ç« ã‚’ãƒŸãƒ‹ãƒ‰ãƒ©èªã«ã—ã¦ã¿ã¾ã—ãŸ

```sh
$ python minidorago.py ãªã‚“ã ã€ã„ã¤ã‚‚ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹
ãªã‚“ã ã€ã„ã¤ã‚‚ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹
â†“
ãƒŠãƒ¼ãƒŠãƒ¼ã‚¤ãƒ¼ã‚¤ãƒ¼ãƒ‘ãƒ¼ãƒ‘ãƒ¼

$ python minidorago.py ã¿ã‚“ãªã®ãƒãƒ¼ãƒˆæ‰“ã¡æŠœãããƒ¼
ã¿ã‚“ãªã®ãƒãƒ¼ãƒˆæ‰“ã¡æŠœãããƒ¼
â†“
ãƒŸãƒ¼ãƒŸãƒ¼ãƒãƒ¼ãƒãƒ¼ã‚¦ãƒ¼ã‚¦ãƒ¼

$ python minidorago.py ä¿ºã®éš£ãŒã‚¤ãƒ³ã‚¹ã‚¿æ˜ ãˆ
ä¿ºã®éš£ãŒã‚¤ãƒ³ã‚¹ã‚¿æ˜ ãˆ
â†“
ã‚ªãƒ¼ã‚ªãƒ¼ãƒˆãƒ¼ãƒˆãƒ¼ã‚¤ãƒ¼ã‚¤ãƒ¼ãƒãƒ¼ãƒãƒ¼
```

ã‚‚ã®ã«ã‚ˆã£ã¦ã¯ã†ãªã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ãªãƒ»ãƒ»ãƒ»w

# çµ‚ã‚ã‚Šã«

ã“ã‚Œã‚’ä½¿ãˆã°ã¿ã‚“ãªã‚‚ãƒŸãƒ‹ãƒ‰ãƒ©èªã‚’è©±ã›ã‚‹ã®ã§ã€ãƒŸãƒ‹ãƒ‰ãƒ©ã®ã‚ˆã†ãªå¯æ„›ã•ã§ä¼šè©±ãŒã§ãã‚‹ã‚ˆã†ã«(?)ãªã‚Šã¾ã—ãŸ

```sh
$ python minidorago.py æœ€å¾Œã¾ã§ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ
æœ€å¾Œã¾ã§ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ
â†“
ã‚µãƒ¼ã‚µãƒ¼ã‚¢ãƒ¼ã‚¢ãƒ¼
```
~~ä¼ã‚ã‚‹ã‹ã©ã†ã‹ã¯ä¿è¨¼ã§ãã¾ã›ã‚“~~

# å‚è€ƒ

* [å®Ÿã¯ãƒŸãƒ‹ãƒ‰ãƒ©ã£ã¦å–‹ã‚Œã‚‹ãï¼ã€ãƒ‰ãƒ©ãˆã‚‚ã‚“é›‘å­¦ã€‘](https://www.youtube.com/watch?v=XWnXEz5xoIs)(Youtube)
* [COTOHA API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://api.ce-cotoha.com/contents/reference/apireference.html)
* [ã‚ªãƒ¬ ãƒ—ãƒ­ã‚°ãƒ©ãƒ  ã‚¦ã‚´ã‚«ã‚¹ ã‚ªãƒã‚¨ ã‚²ãƒ³ã‚·ã‚¸ãƒ³ ãƒŠãƒ«](https://qiita.com/Harusugi/items/f499e8707b36d0f570c4)(Qiita)
